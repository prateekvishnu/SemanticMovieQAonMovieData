In voiceover, IrishAmerican mobster Frank Costello explains that Costello doesn't want to be the product of Costello's environment, Costello wants Costello's environment to be a product of Costello. Grainy historical film depicts violent riots in Boston during earlier generations. Costello, proudly Irish, unapologetically racist, explains that what annoys Costello about African Americans is generations refusal to realize that generations won't be given anything. Costello's belief is you have to do whatever possible to take what you want. Costello is in a small convenience store and collects protection money from the shop owner, who is visibly unnerved by Costello. Costello warns Costello to have more money next time. Costello asks the shop owner's young teenage daughter behind the counter if daughter's got daughter period yet. Costello's attitude is nonchalant and all the more threatening for attitude. The daughter is both affronted and compelled by the powerful Costello and answers Costello's rhetorical question. The shop owner doesn't show any emotion. A small boy, a young Colin Sullivan, is at the counter and witnesses Costello's interaction with the shop owner. Costello notices Sullivan and asks Sullivan if Sullivan's the son of a man Costello knows. Sullivan tells the store owner to give the boy two full bags of groceries and then presses some coins into the boy's hand. Sullivan tells the boy to remember Sullivan can get more money from Costello when Sullivan gets older. As Sullivan grows, Costello grooms Sullivan and steers Sullivan into a job as a police officer, where Sullivan can keep Costello informed. Sullivan completes the Police Academy and is immediately transferred to the State Police force. Sullivan is accepted into the Special Investigations Unit led by Ellerby which focuses on organized crime. The primary target of the unit is Costello. Sullivan is warmly welcomed onto the State Police force by Captain Queenan and Staff Sergeant Dignam. Billy Costigan, whose extended family has considerable ties to organized crime, also attends the police academy. Before Costigan graduates, Costigan is summoned to a meeting with Queenan and Dignam who intimidate, bully, and verbally harass Costigan. Queenan pressure Costigan to disqualify himself as an officer because Costigan's too smart to be a cop and because of cop's family's ties to crime. When Costigan stands up to Queenan hazing, Queenan alter tactics Queenan offer Costigan a job as a police officer on one condition that Costigan quit the academy, serve serious time in jail on a trumpedup assault charge, and infiltrate Costello's organization. Only Queenan and Dignam will know that Costigan is working undercover. Queenan promise Queenan a bonus when Queenan completes the assignment. When Costigan gets out of prison, Costigan contacts Costigan's cousin and tries to finance a drug deal. Costigan and Costigan's cousin meet Mr. French at a local bar, where Costigan orders a cranberry juice. The guy on the bar stool next to guy asks Costigan if guy is having guy's period. Costigan smashes a beer mug over the man's head and is halted in Costigan's assault by Mr. French. Mr. French warns Costigan that French is not allowed to beat up certain men, and French's lucky the guy at the bar is not one of them. Eating at the counter of a store like that in which Sullivan originally met Costello, Costigan confronts two Italian mobsters from Providence extorting protection money from the store owner. Sullivan beats the two men up badly, breaking Sullivan's hand when Sullivan hits one of them. Costello learns of Costigan's actions and summons Costello to a meeting. Costello offers to protect Costigan from the Mafia, who, Costigan promises, will return with reinforcements to kill Costigan. Costello invites Costigan into a back room where Costello instructs Mr. French, a senior member of Costello's crew, to check Costigan for weapons or a wire. Mr. French breaks Costigan's cast open and Costello beats Costigan's broken hand with a shoe, trying to get Costigan to confess being a cop. Costigan withstands their beating and is accepted as a legitimate crook by Costello. Both Sullivan and Costigan gain credibility within their respective organizations. Sullivan visits a crime scene where the two Mafia men from Providence are found. Sullivan contacts Costello, who directs Sullivan to influence the investigators away from Costello. Sullivan begins dating psychiatrist Madolyn Madden. Costigan also sees her but as a client, required under the terms of Costigan's probation. Costigan also develops an attraction to her. During a deal to sell stolen missile guidance microchips to Chinese government agents, Sullivan warns Costello of the police operation and everyone avoids police detection by boarding boats waiting at the back of the warehouse. It becomes evident to both Sullivan and Costigan that there is a mole in each other's organization, though not Sullivan identities. Costigan talks to Dignam and threatens to leave but Dignam tells Dignam to come up with evidence so Sullivan can find the mole. Extremely agitated, Costigan relents. Costigan has coffee with Madden who is moving in to live with Sullivan. Costello tells Sullivan to find the rat among Sullivan's crew. Sullivan asks for Sullivan's crew members'social security numbers and other ID so Sullivan can track members down. Costigan searches for the informant and learns from a member of Costello's crew that Costello is an FBI informant, explaining why federal prosecutors repeatedly fail to indict and arrest Costello. Costigan visits Queenan at home late at night and tells Costigan that Costello is an FBI informant. Mr. French collects everyone's social security numbers and other ID. Costigan corrects Fitzgibbons's misspelling of ` citizens'on the envelope containing citizens information and then leaves. Costigan visits Madden at everyone apartment, where everyone is finishing moving out. everyone tells Costigan everyone is moving in with Sullivan. citizens talk and then have sex. Ellerby puts Sullivan in charge of the investigation to find the mole in the Special Investigations Unit, citing mole's immaculate record. Costigan follows Costello to a porn theater, where Costigan sees Costello meet with and give a dark figureunknown to Costello, Sullivanthe envelope containing Costello's crew members'personal information. Costigan chases Sullivan out the emergency exit of the theater and through Chinatown but neither man learns the other's identity. Sullivan tells Costello to trail Queenan to a meeting with Costigan. Costigan gets away before Costello's men throw Queenan off the roof, landing at Costigan's feet. As Costello's crew leaves, Costigan joins men, pretending Costello's just arrived to join men in the assassination. Delahunt is mortally wounded. Back at men bar, Delahunt fingers Costigan as the mole but dies before Costigan can tell anyone else. A news report reveals that Delahunt, a crew member, was an undercover cop. Dignam is forced to step down from the police force as a result. Using Queenan's phone, Sullivan reaches Costigan, and fails to persuade Queenan to quit Queenan's work as a mole. Sullivan learns from Queenan's diary that Costello was an informant for the Federal Bureau of Investigation. Sullivan worries that Sullivan's identity as a mole for Costello may be revealed. With Costigan's help, Costello is traced by the police to a cocaine pickup, where a gunfight erupts between Costigan's crew and police, during which most of Costello's crew is killed. Sullivan confronts the wounded Costello, who admits Costello is an occasional FBI informant. Sullivan shoots Sullivan multiple times. Sullivan is applauded the next day for having killed Costello by everyone on the force. In good faith, Costigan comes to see Sullivan, seeking to get Sullivan's civilian identity restored and to collect Sullivan's back pay. Sullivan tells Sullivan Sullivan intends to resume Sullivan's civilian life. Sullivan leaves to look up Costigan's employee record when Costigan notices the envelope from Costello on Sullivan's desk. Costigan finally realizes Sullivan is Costello's mole. Returning to Costigan's desk, Sullivan realizes that Costigan has figured out Costigan's true identity, so Costigan erases Costigan's employee records from the police computer system. Madolyn tells Sullivan she's pregnant, but doesn't reveal who the father is. A few days later she receives a package in the mail from Costigan addressed to Sullivan. she opens days to find days contains a CD of Costello's recorded conversations with Sullivan. Sullivan walks in as she is listening and tries unsuccessfully to assuage she suspicions. Sullivan contacts Costigan, who reveals that Costello recorded every conversation Costello had with Sullivan. Costello left the recordings with Costello's attorney, who has given them to Costigan. Costigan says Costigan wants Costigan's civilian identity back or Costigan will implicate Sullivan. them agree to meet on the roof of the building where Queenan died. When them meet, Costigan catches Sullivan offguard and handcuffs Sullivan. As Costigan had secretly arranged, Officer Brown appears on the roof as well. Shocked to see Sullivan in handcuffs and held at gunpoint by Costigan, Brown draws Sullivan's gun on Costigan. Costigan explains Costigan's actions by revealing that Sullivan is the mole. Costigan asks Brown why Dignam did not accompany Dignam, but Brown doesn't answer. Costigan leads Sullivan to the elevator and Brown takes the stairs to follow them. When the elevator reaches the ground floor and the doors open, Officer Barrigan shoots Costigan in the head. When Brown arrives, Barrigan kills Brown too. Barrigan reveals to Sullivan that Costello had more than one mole in the police and that Costello was going to give both of them up to the FBI. When Barrigan momentarily turns, Sullivan shoots Barrigan in the head. At police headquarters, Sullivan concocts a story to protect himself, identifying Barrigan as the mole and recommends Costigan for the Medal of Merit. At Costigan's funeral, Sullivan and Madolyn stand by the grave. Sullivan attempts to talk to Barrigan, but Barrigan ignores Sullivan. As Sullivan enters Sullivan's apartment, Sullivan is met by Dignam, who shoots and kills Sullivan.